<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Goengine : Boilerplate for Go uses Sinatra style routing with some features from HTML5-Boilerplate along with Twitter Bootstrap 2.0" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Goengine</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/ninnemana/goengine">View on GitHub</a>

          <h1 id="project_title">Goengine</h1>
          <h2 id="project_tagline">Boilerplate for Go uses Sinatra style routing with some features from HTML5-Boilerplate along with Twitter Bootstrap 2.0</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/ninnemana/goengine/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/ninnemana/goengine/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>GoEngine Boilerplate <a href="https://travis-ci.org/ninnemana/goengine"><img src="https://travis-ci.org/ninnemana/goengine.png?branch=non-appengine" alt="Build Status"></a>
</h1>

<p>GoEngine Boilerplate is combination of serveral different repositories, some made for Go some not.</p>

<p>The project is built using with Sinatra style routing and MySQL support. HTML Structure and design using h5bp(<a href="http://html5boilerplate.com">http://html5boilerplate.com</a>) and Twitter Bootstrap(<a href="http://twitter.github.com/bootstrap">http://twitter.github.com/bootstrap</a>). Javascript templating is done with mustache.js, but has not been baked into requireJS. The javascript component incorporates RequireJS for dependency management.</p>

<p><strong>IMPORTANT</strong>: If you <strong><strong>are</strong></strong> using Google AppEngine, use the <a href="https://github.com/ninnemana/goengine/tree/gae"><em>gae</em></a> branch.</p>

<h2>Deploying</h2>

<p>You can deploy this app manually or using Capistrano.  If you choose to use Capistrano, here's an example to prompt for populating the ConnectionString so you can keep it out of your public repo for testing purposes:</p>

<div class="highlight"><pre><span class="n">default_run_options</span><span class="o">[</span><span class="ss">:pty</span><span class="o">]</span> <span class="o">=</span> <span class="kp">true</span>
<span class="n">ssh_options</span><span class="o">[</span><span class="ss">:forward_agent</span><span class="o">]</span> <span class="o">=</span> <span class="kp">true</span>


<span class="n">set</span> <span class="ss">:application</span><span class="p">,</span> <span class="s2">"ApplicationName"</span>
<span class="n">set</span> <span class="ss">:appname</span><span class="p">,</span>     <span class="s2">"application-name"</span>
<span class="n">set</span> <span class="ss">:repository</span><span class="p">,</span>  <span class="s2">"git@github.com:youraccount/yourrepo.git"</span>

<span class="n">set</span> <span class="ss">:scm</span><span class="p">,</span> <span class="ss">:git</span>
<span class="n">set</span> <span class="ss">:scm_passphrase</span><span class="p">,</span> <span class="s2">""</span>
<span class="n">set</span> <span class="ss">:user</span><span class="p">,</span> <span class="s2">"linuxuser"</span>

<span class="n">role</span> <span class="ss">:web</span><span class="p">,</span> <span class="s2">"server1.address.com"</span><span class="p">,</span> <span class="s2">"server2.address.com"</span>
<span class="n">role</span> <span class="ss">:app</span><span class="p">,</span> <span class="s2">"server1.address.com"</span><span class="p">,</span> <span class="s2">"server2.address.com"</span>

<span class="n">set</span> <span class="ss">:deploy_to</span><span class="p">,</span> <span class="s2">"/home/</span><span class="si">#{</span><span class="n">user</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">application</span><span class="si">}</span><span class="s2">"</span>
<span class="n">set</span> <span class="ss">:deploy_via</span><span class="p">,</span> <span class="ss">:remote_cache</span>

<span class="n">set</span> <span class="ss">:use_sudo</span><span class="p">,</span> <span class="kp">false</span>
<span class="n">set</span> <span class="ss">:sudo_prompt</span><span class="p">,</span> <span class="s2">""</span>
<span class="n">set</span> <span class="ss">:normalize_asset_timestamps</span><span class="p">,</span> <span class="kp">false</span>

<span class="n">after</span> <span class="ss">:deploy</span><span class="p">,</span> <span class="s2">"deploy:goget"</span><span class="p">,</span> <span class="s2">"db:configure"</span><span class="p">,</span> <span class="s2">"deploy:compile"</span><span class="p">,</span> <span class="s2">"deploy:stop"</span><span class="p">,</span> <span class="s2">"deploy:restart"</span>

<span class="n">namespace</span> <span class="ss">:db</span> <span class="k">do</span>
  <span class="n">desc</span> <span class="s2">"set database Connection String"</span>
  <span class="n">task</span> <span class="ss">:configure</span> <span class="k">do</span>
    <span class="n">set</span><span class="p">(</span><span class="ss">:database_username</span><span class="p">)</span> <span class="p">{</span> <span class="ss">Capistrano</span><span class="p">:</span><span class="ss">:CLI</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">"Database Username:"</span><span class="p">)</span> <span class="p">}</span>

    <span class="n">set</span><span class="p">(</span><span class="ss">:database_password</span><span class="p">)</span> <span class="p">{</span> <span class="ss">Capistrano</span><span class="p">:</span><span class="ss">:CLI</span><span class="o">.</span><span class="n">password_prompt</span><span class="p">(</span><span class="s2">"Database Password:"</span><span class="p">)</span> <span class="p">}</span>

    <span class="n">db_config</span> <span class="o">=</span> <span class="o">&lt;&lt;-</span><span class="no">EOF</span>
<span class="sh">      package database</span>

<span class="sh">      const (</span>
<span class="sh">        db_proto = "tcp"</span>
<span class="sh">        db_addr  = "databaseaddress:3306"</span>
<span class="sh">        db_user  = "#{database_username}"</span>
<span class="sh">        db_pass  = "#{database_password}"</span>
<span class="sh">        db_name  = "databasename"</span>
<span class="sh">      )</span>
<span class="no">    EOF</span>
    <span class="n">run</span> <span class="s2">"mkdir -p </span><span class="si">#{</span><span class="n">deploy_to</span><span class="si">}</span><span class="s2">/current/helpers/database"</span>
    <span class="n">put</span> <span class="n">db_config</span><span class="p">,</span> <span class="s2">"</span><span class="si">#{</span><span class="n">deploy_to</span><span class="si">}</span><span class="s2">/current/helpers/database/ConnectionString.go"</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="n">namespace</span> <span class="ss">:deploy</span> <span class="k">do</span>
  <span class="n">task</span> <span class="ss">:goget</span> <span class="k">do</span>
    <span class="n">run</span> <span class="s2">"/usr/local/go/bin/go get github.com/ziutek/mymysql/native"</span>
    <span class="n">run</span> <span class="s2">"/usr/local/go/bin/go get github.com/ziutek/mymysql/mysql"</span>
  <span class="k">end</span>
  <span class="n">task</span> <span class="ss">:compile</span> <span class="k">do</span>
    <span class="n">run</span> <span class="s2">"GOOS=linux GOARCH=amd64 CGO_ENABLED=0 /usr/local/go/bin/go build -o </span><span class="si">#{</span><span class="n">deploy_to</span><span class="si">}</span><span class="s2">/current/</span><span class="si">#{</span><span class="n">appname</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">deploy_to</span><span class="si">}</span><span class="s2">/current/index.go"</span>
  <span class="k">end</span>
  <span class="n">task</span> <span class="ss">:start</span> <span class="k">do</span> <span class="p">;</span> <span class="k">end</span>
  <span class="n">task</span> <span class="ss">:stop</span> <span class="k">do</span> 
      <span class="n">kill_processes_matching</span> <span class="s2">"</span><span class="si">#{</span><span class="n">appname</span><span class="si">}</span><span class="s2">"</span>
  <span class="k">end</span>
  <span class="n">task</span> <span class="ss">:restart</span> <span class="k">do</span>
    <span class="n">restart_cmd</span> <span class="o">=</span> <span class="s2">"</span><span class="si">#{</span><span class="n">current_release</span><span class="si">}</span><span class="s2">/</span><span class="si">#{</span><span class="n">appname</span><span class="si">}</span><span class="s2"> -http=127.0.0.1:8080 -path=</span><span class="si">#{</span><span class="n">deploy_to</span><span class="si">}</span><span class="s2">/current/"</span>
    <span class="n">run</span> <span class="s2">"nohup sh -c '</span><span class="si">#{</span><span class="n">restart_cmd</span><span class="si">}</span><span class="s2"> &amp;' &gt; nohup.out"</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">kill_processes_matching</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
  <span class="n">run</span> <span class="s2">"ps -ef | grep </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2"> | grep -v grep | awk '{print $2}' | sudo xargs kill -2 || echo 'no process with name </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2"> found'"</span>
<span class="k">end</span>

</pre></div>

<p>Depending on the server you're on, you may need to define the path of the application as a flag in the deployment script or when running manually on the server. The reason for that is the server may have issues pathing the static files in the project. The example in the script above should help get the deployment working properly with the right static file paths.</p>

<h2>Mustache.js</h2>

<p>mustache.js has been converted to use [[ ]] as delimiters so it can play nice with golang's html/template package.</p>

<h2>Contributors</h2>

<p><strong>Alex Ninneman</strong></p>

<ul>
<li><a href="http://twitter.com/ninnemana">http://twitter.com/ninnemana</a></li>
<li><a href="http://github.com/ninnemana">http://github.com/ninnemana</a></li>
</ul><p><strong>Jessica Janiuk</strong></p>

<ul>
<li><a href="http://twitter.com/janiukjf">http://twitter.com/janiukjf</a></li>
<li><a href="http://github.com/janiukjf">http://github.com/janiukjf</a></li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Goengine maintained by <a href="https://github.com/ninnemana">ninnemana</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-35706556-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
